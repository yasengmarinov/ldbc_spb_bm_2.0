PREFIX inst: <http://www.ontotext.com/connectors/mongodb/instance#>
PREFIX : <http://www.ontotext.com/connectors/mongodb#>
PREFIX cwork: <http://www.bbc.co.uk/ontologies/creativework/>
PREFIX dbpedia:	<http://dbpedia.org/resource/>
PREFIX ldbcspb: <http://www.ldbcouncil.org/spb#>
PREFIX bbc: <http://www.bbc.co.uk/ontologies/bbc/>
PREFIX geo-ont: <http://www.geonames.org/ontology#>
PREFIX core: <http://www.bbc.co.uk/ontologies/coreconcepts/>
select ?entity ?title ?description ?dateModified ?primaryContent where{
    {
select (group_concat(?creativeWork; separator = '", "') as ?ids) where{
select distinct ?creativeWork{
{
SELECT distinct ?e
    {
      {
        {{{entitiyOfInterest}}} ?p ?e .
      }
      UNION
      {
        ?e ?p {{{entitiyOfInterest}}} .
      }
      ?e a core:Thing .
    }
}
    ?creativeWork cwork:tag ?e
  } limit 10
}
        }
         values ?template {
        '''{"@graph.0.@id" : {$in :["$arg1"]}}'''
        }
        bind (replace(str(?template), "\\$arg1", str(?ids)) as ?mongoQuery )

    {
     	 ?search a inst:spb100 ;
               :find ?mongoQuery ;
                    :entity ?entity .
            graph inst:spb100 {

                ?entity a ?type .
                OPTIONAL {?entity cwork:title ?title }
          		  OPTIONAL {?entity cwork:description?description }
          		  OPTIONAL {?entity cwork:dateModified ?dateModified }
                  OPTIONAL {?entity bbc:primaryContentOf ?primaryContent  }


            }

        }

    }ORDER BY DESC(?dateModified) LIMIT 100